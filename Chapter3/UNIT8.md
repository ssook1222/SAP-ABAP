# Unit8 - ABAP Workbench / Transport Organizer / ABAP 프로그램 개발 

### ABAP Workbench
ABAP development를 관리하는 하나의 툴

### ABAP Repository(오브젝트가 관리되는 곳) 실행방식

어플리케이션 서버에서 Abap 프로그램이 실행되지만, 실제 프로그램에 대한 소스코드는 데이터베이스 서버의 레포지토리에 존재.    
그래서 레포지토리는 모든 시스템 개발 오브젝트(프로그램, 함수 모듈, 데이터베이스 정의 등)으로 구성    
레포지토리 오브젝트에는 SAP standard object 뿐만이 아니라 개발자가 개발한 것(CBO)도 있음.   
Abap Repository는 모든 클라이언트에 독립적임. 클라이언트에 상관없이 모두 동일하게 보임.
Repository와 달리 데이터베이스에는 클라이언트에 의존적인 데이터도 존재함.    
어플리케이션 커스터마이징 데이터들은 일반적으로 specific한 특징들을 지님.   
로그온한 클라이언트에 따라 해당 정보들은 다른 데이터가 보일 수도 있음.     

---
### Repository 구조

각각의 패키지로 나눠 관리. 각 패키지 안에는 서브 패키지가 있고, 그 안에 개발 오브젝트(프로그램, 테이블 정의, 함수 모듈)들이 있음.
Repository Object를 검색할 수 있는 툴(=Repository Information System)에 대한 설명
레포지토리 안에 있는 모든 오브젝트들을 해당 툴을 통해 검색 가능함.

이 툴의 T Code는 SE84임.     
오브젝트 타입을 더블클릭하면, 오브젝트 타입별로 검색할 수 있는 Selection Screen이 나옴.
Selection Screen에 원하는 검색 조건을 준 다음 오브젝트를 찾으면 됨.



### 해당 툴에 접근할 수 있는 방법 2가지

SAP Easy Access 메뉴에서 Tools → ABAP Workbench → Overview → Information System으로 접근,    
아니면 SE84 T코드로 툴 실행
툴이 실행될 때 오브젝트 타입을 더블 클릭하여 실행하면, 해당 오브젝트 타입에 대해 검색할 수 있는 selection screen이 나타나고 검색 조건을 제한할 수 있음.

(추가)

SAP Application Hierarchy를 통해 접근하는 방법도 있음.    
많은 어플리케이션 컴포넌트들이 있는데 이 곳에서 볼 수 있고, 트리를 열어 각 컴포넌트들을 클릭하면 패키지들을 볼 수 있음. 
패키지를 선택하고 repository information system을 누르면 해당 패키지 내에서 repository object를 검색할 수 있게 세팅되어 해당 툴이 실행됨.

### SAP Application Hierarchy에 접근하는 방법 3가지

SAP Easy Access 메뉴에서 Tools → ABAP Workbench → Overview → Application Hierarchy → SAP으로 접근,
아니면 SE81 T코드로 툴 실행.   
어플리케이션 컴포넌트를 열고, 패키지를 선택한다.    
그 다음 선택 버튼을 누르고 레포지토리 인포메이션 시스템으로 접속.  

### ABAP Workbench Tools
디버거, 스크린 페인터, 메뉴 페인터, ABAP Editor, Function Builder, Class Builder, ABAP Dictionary 등의 도구가 제공

이 툴들은 서로 다른 개발 오브젝트들을 수정하거나 변경할 수 있는 툴.    
Object Navigator(= SE80번)를 통해 ABAP Workbench Tools을 사용 가능함.
소스코드를 변경할 수 있는 ABAP 에디터, 데이터베이스 테이블 및 타입을 정의 가능한 ABAP 딕셔너리, 스크린을 정의할 수 있는 스크린 페인터, 메뉴를 디자인할 수 있는 메뉴 페인터, 함수 모듈을 관리할 수 있는 fuction Builder, 클래스와 인터페이스를 관리할 수 있는 Class Builder를 제공

### Object Navigator 내의 Screen Layout

- Fullscreen on/off
- Navigation Area
- Tool Area
- Context Menu
- Right
- mouse click
- Right
- mouse click
- Context Menu
- Size of display area can be changed

네비게이션 영역에서는 오브젝트들을 선택 가능하며, 오브젝트를 더블 클릭하여 선택할 경우  
툴 영역에 workbench tool이 실행되면서 선택한 오브젝트의 상세 정보를 볼 수 있음.
오브젝트 네비게이터의 스크린은 두 가지 에리어로 나뉘어 있음.    
- 네비게이션 영역 : 오브젝트를 계층적으로 보여줌
- 최상단 리스트박스 : 오브젝트 타입을 선택할 수 있음.   
오브젝트 타입을 선택한 후 오브젝트 이름을 input field에 작성하면 됨.    
이 밑에 있는 것을 볼 때, 오브젝트 이름을 친 후 엔터를 치면 해당 오브젝트에 대한 오브젝트 리스트들이 나옴.
Higher-level-object list : 한 단계 위의 오브젝트들을 조회할 수 있는 리스트 (그 오브젝트가 속한 패키지를 조회할 수 있음)
  
툴 영역 : 적합한 툴을 사용하여 개발 오브젝트를 조회하거나 수정할 수 있음.
오브젝트의 상세 내역을 적합한 워크벤치 툴을 사용해 보여줌.
툴 영역 위의 Show Navigation Window를 누르면    
하단에 창이 하나 뜨면서 과거 조회했던 오브젝트 형식들이 히스토리 형태로 나타나며, 재 조회 가능.   

툴 영역에 나타날 수 있는 워크벤치 툴이 여러가지가 있는데 그 툴마다 종속적인 기능이 상단에 나타날 수 있게끔 되어 있음.



### 네비게이션 영역과 툴 영역 동기화

실제로 오브젝트 네비게이터를 사용하다보면, 이 두 영역이 제대로 동기화되지 않을 때가 있음.   
네비게이션 영역을 기준으로 동기화를 하고 싶으면, 네비게이션 영역에서 더블 클릭하면 됨.   
툴 영역을 기준으로 동기화하고 싶을 경우 우측의 Display Object List를 누르면 됨.


## Lesson2. ABAP 개발 프로젝트 Organizing

### 개발 오브젝트의 전송

보통 SAP 시스템은 개발 시스템, 운영 시스템, 테스트 시스템 3가지가 있음.  
개발 시스템에서 개발한 내용을 타 시스템으로 전송해야 하는데, 그 단위가 Change Request임.
프로젝트 시작 시점에 프로젝트 매니저가 Change Request를 생성하고 
해당 Change Request에 프로젝트 멤버들을 위하여 태스크를 생성해 줌.      

### Transport Organizer (T code : SE09)
이 곳에서 Change Request를 생성할 수 있음.
프로젝트가 시작되기 전에 프로젝트 리더가 change request를 만듦.   
각 프로젝트 멤버들을 위해 프로젝트 리더가 task를 생성함.
예를 들어 BC-400의 00번 employee가 Report Source 코드를 생성했다고 하면 
소스코드 밑에 Development object들이 하단에 연결되어 있음.    

Change Request를 사용하여 개발 프로젝트를 관리하면,
프로젝트 멤버들은 자신이 개발한 내용을 모니터링 가능함.
해당 프로젝트와 관련되어 있는 프로젝트 멤버들은 프로젝트에 할당되어 있는 모든 레포지토리 오브젝트들을 처리할 수 있음.
프로젝트 동안 생성되거나, 변경된 오브젝트들은 change request가 release되면 자동으로 이관됨.

개발 오브젝트들을 생성하거나 수정하기 위해서는, 반드시 패키지를 생성해야 함.   
- 패키지 : 패키지명 입력, Customer Namespace Rule에 따라 Z로 시작해야 됨. Y는 테스트용
- 짧은 설명 : 해당 패키지에 대한 짧은 설명을 간략히 작성
- 어플리케이션 컴포넌트 : 해당 패키지가 어느 어플리케이션 컴포넌트에 속하는지 작성
- 소프트웨어 컴포넌트 : Customer Development일 경우 HOME으로 작성
- 전송 계층 : 이 패키지 내에 있는 오브젝트들이 어떤 시스템으로 이관될 지 정보를 넣는

### 패키지 타입 작성
#### 전송 계층에 대한 설명

전송계층 정보는 패키지를 생성할 때 넣어야 함.     
패키지 생성할 때 해당 정보가 자동으로 들어오기 때문에 크게 신경안써도 됨.     

> DEV : 개발 / QAS : 테스트 / PRD : 운영

DEV에서 변경사항이 생기면, 타 시스템으로 변경된 내용(change Request)이 이관함.    
이때 전송계층을 타고 이동함.
ZDEV는 패키지를 생성할 때 넣어주는 정보임.     
SAP 전송 계층은 SAP 표준 소프트웨어를 수정하는 기능이 있음. 해당 부분에서 수정하고 SAP 전송 계층으로 이동함.    
따라서 패키지를 생성하면, 패키지에 change Request를 할당해야 됨.    
change Request를 만들면, 그 밑에 패키지가 붙고, 개발 오브젝트가 붙는 형태임.    



### ABAP 프로그램 개발
#### ABAP 프로그램_생성
리포트 프로그램의 경우 SE30번이나 SE80번에서 만들 수 있음.    
리포트 프로그램은 with Top include 옵션 해제
프로그램 이름의 경우 Customer Development다 보니까 customer namespace를 준수하여 Z이나 Y로 만들어야 함.     

### Executable program
#### ABAP 언어 특성

타입으로 이뤄져 있어 타입 캐스팅이나 conversion이 지원됨.
- 번역 가능한 텍스트로 다국어 지원    
- Open SQL이어서 SQL 접근 가능
- 객체 지향 언어 지향    
- 데이터베이스, OS 플랫폼 독립적
- 하위버전 호환성 지원

### ABAP 문법
일반적으로 ABAP 언어에 대한 문장은
ABAP 키워드(사전에 정의됨) / Additions and Operands(키워드에 따라 알맞게 변경됨) / Period(모든 문장의 끝은 마침표)     
New Line 보면 알 수 있듯, 어떤 키워드는 아무런 Additions and Operands도 필요로 하지 않음.      
키워드는 무조건 나오지만 뒤의 내용은 키워드가 어떤 것인지에 따라 나올 수도, 안 나올 수도 있음.    

### ABAP 문법의 특성

ABAP 프로그램은 개별 문장으로 구성됨    
문장의 첫 번째 단어는 ABAP 키워드를 사용하며, 모든 문장은 온점으로 끝남.
두 단어 사이에는 공백을 넣어줘야 함.
들여쓰기가 가능함.    
ABAP 런타임 시스템은 대소문자를 구별하지 않음.

### 주석과 Chained Statement
Line의 첫번째 컬럼에 *가 있을 경우 해당 라인은 전부 주석처리됨.   
중간에 "가 있을 경우 그 "부터 끝까지는 주석처리됨.     
Chained Statement는 키워드를 중복해서 써야 될 일이 있을 때, 이를 간단하게 하나로 합치는 방법    
아래와 같은 형태로 작성하면 됨.

```
중복해서 사용할 키워드 : 문장1
                   , 문장2 . (해당 문장의 끝에는 온점으로 작성!)

```

### ABAP 에디터에서 Keyword Document에 접근하는 방법
찾아보고자 하는 키워드를 드래그한 다음, F1 키를 누르면 됨
I라는 버튼을 누르면 키워드 문서를 검색할 수 있는 창이 뜨는데, ABAP 텀에서 키워드를 검색하여 확인을 누르면 해당 키워드에 해당하는 문서 확인 가능
북마크 기능, 수정한 라인 자동으로 표시해주는 기능, Ctrl+space를 누르면 필요한 키워드를 자동으로 추천해줌.     

### 개발 오브젝트의 활성화 / 비활성화
- Saved Programs은 inactive 버전
- Activated Programs은 active 버전,    
Abap 개발 오브젝트는 활성화 / 비활성화 버전 두 개로 관리되고 있음.

만약 활성화 버전으로 있는 프로그램을 수정 모듈로 수정 후 저장하면 활성화 / 비활성화 버전 둘 다 있음.    
비활성화 버전에 에러가 없으면 활성화되면서 비활성화 버전은 사라지고 원래 있던 활성화 버전을 새로 만든 활성화 버전으로 overwrite함.

### 개발 오브젝트의 활성화 기능

비활성화 버전으로 오브젝트를 저장
비활성화 버전의 문법 및 일관성을 확인    
확인이 성공하면, 새로운 활성화 버전 생성하여 기존에 있던 활성화 버전을 overwrite함.
해당 오브젝트가 프로그램이라면 다음에 빠른 실행을 위해 런타임 오브젝트를 생성

### 런타임 오브젝트

비활성화 버전은 Abap 에디터를 통해서만 실행이 가능함.   
실행될 때마다 런타임 오브젝트는 재생성됨.   
활성화 버전은 Abap 에디터가 아닌 Tcode 등으로 접근했을 때 전부 실행됨.
활성화 버전 런타임 오브젝트의 경우, 오브젝트 활성화 시 미리 생성됨.    
프로그램을 언제 실행하던 상관없이 미리 생성된 오브젝트를 사용함.
프로그램의 빠른 실행을 위해 프로그램에 있는 정보를 미리 다 정의해 놓은 것.
특히 버퍼에서부터 가져오므로, 이를 통해 실행 속도가 현격히 빨라짐을 알 수 있음.
Abap Editor에서 F8키를 누르면 inactive 버전이 실행됨.
그 외에는 Active 버전이 실행됨.

### ABAP 프로그램 활성화
프로그램 문법에 Activate 버튼을 클릭하여 프로그램을 활성화시킴.    
해당 프로그램을 활성화시켜야지만 실행을 할 수 있음.    



### Lesson4. ABAP Development 프로젝트를 끝내는 방법

#### 트랜잭션 생성 법
프로그램을 만들어도 트랜잭션이 없다면, ABAP 에디터에서 실행해야 함.
SAP 일반 사용자의 경우 ABAP 에디터에 대한 접근 권한이 없음.
사용자들이 해당 프로그램을 실행시킬 수 있게끔 프로그램을 만들면, 트랜잭션 코드를 생성시켜줘야 함.
트랜잭션 코드는 해당 코드와 연결되어 있는 프로그램을 실행시켜주는 역할을 수행함.     

트랜잭션 코드는 오브젝트 네비게이터에서 우클릭하여 생성 가능함.   
SE93으로 접속해서도 생성 가능함.    
트랜잭션 코드 생성 시 어느 프로그램을 실행시킬 지, 해당 프로그램에 대한 정보도 넣어줘야 함.     

#### 생성한 트랜잭션 코드를 즐겨찾기에 등록하는 방법
프로젝트가 완료되면 프로젝트 멤버들은 자신이 수행한 업무를 전부 release해야 됨.   
그리고 task가 다 release되면 태스크 안 모든 오브젝트들은 모두 lock이 걸려 수정이 불가능함.   
문법 오류가 있거나, inactive 상태면 release가 안 됨.   
모든 release가 끝나면 프로젝트 매니저는 change request 자체를 release하며 종료됨.
Change Request가 끝나면, 모든 오브젝트의 lock이 해제됨.
Release된 오브젝트는 다른 시스템으로 이관됨.     

 

 

 